<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í† ìŠ¤íŠ¸ ì•Œë¦¼ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 40px;
            background: #f5f7fa;
        }
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        button {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-primary {
            background: #667eea;
            color: white;
        }
        .btn-primary:hover {
            background: #5568d3;
        }
        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }
        .btn-secondary:hover {
            background: #e0e0e0;
        }
        .info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
            color: #1976d2;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”” ë°±ê·¸ë¼ìš´ë“œ í† ìŠ¤íŠ¸ ì•Œë¦¼ í…ŒìŠ¤íŠ¸</h1>

        <div class="info">
            ì´ í˜ì´ì§€ì—ì„œ í…ŒìŠ¤íŠ¸ í† ìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ê³  ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ì´ë™í•´ë„ ì•Œë¦¼ì´ ìœ ì§€ë˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </div>

        <div class="btn-group">
            <button class="btn-primary" onclick="testProcessingTask()">
                ğŸ“„ ì²˜ë¦¬ ì¤‘ ì‘ì—… ì‹œë®¬ë ˆì´ì…˜
            </button>
            <button class="btn-primary" onclick="testCompletedTask()">
                âœ… ì™„ë£Œëœ ì‘ì—… ì‹œë®¬ë ˆì´ì…˜
            </button>
            <button class="btn-primary" onclick="testErrorTask()">
                âŒ ì‹¤íŒ¨í•œ ì‘ì—… ì‹œë®¬ë ˆì´ì…˜
            </button>
            <button class="btn-secondary" onclick="clearAllToasts()">
                ğŸ—‘ï¸ ëª¨ë“  í† ìŠ¤íŠ¸ ì œê±°
            </button>
            <button class="btn-secondary" onclick="window.location.href='./pages/dashboard-policy.html'">
                ğŸ  ëŒ€ì‹œë³´ë“œë¡œ ì´ë™ (í† ìŠ¤íŠ¸ ìœ ì§€ í…ŒìŠ¤íŠ¸)
            </button>
        </div>
    </div>

    <script src="./toast-notification.js"></script>
    <script>
        // ê°€ìƒì˜ task ID ìƒì„±
        function generateTaskId() {
            return 'test-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        }

        function testProcessingTask() {
            const taskId = generateTaskId();
            const toast = initBackgroundTaskToast();

            if (toast) {
                toast.addTask(
                    taskId,
                    'ğŸ“„ í…ŒìŠ¤íŠ¸ ì •ì±… ë¬¸ì„œ.pdf',
                    'PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ ë° ìŠ¤í‚¤ë§ˆ ìƒì„± ì¤‘...'
                );

                // ì§„í–‰ ìƒí™© ì‹œë®¬ë ˆì´ì…˜
                let progress = 0;
                const interval = setInterval(() => {
                    progress += 10;
                    const taskData = toast.tasks.get(taskId);
                    if (taskData) {
                        taskData.progress = progress;
                        taskData.currentStep = `ì²˜ë¦¬ ì¤‘... ${progress}%`;
                        toast.updateToast(taskData);

                        if (progress >= 100) {
                            clearInterval(interval);
                            taskData.status = 'completed';
                            taskData.currentStep = 'ì™„ë£Œ!';
                            toast.updateToast(taskData);
                        }
                    } else {
                        clearInterval(interval);
                    }
                }, 1000);

                alert('ì²˜ë¦¬ ì¤‘ ì‘ì—…ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì§„í–‰ ìƒí™©ì„ í™•ì¸í•˜ì„¸ìš”!');
            }
        }

        function testCompletedTask() {
            const taskId = generateTaskId();
            const toast = initBackgroundTaskToast();

            if (toast) {
                toast.addTask(
                    taskId,
                    'ğŸ“„ ì™„ë£Œëœ ì •ì±… ë¬¸ì„œ.pdf',
                    'ìŠ¤í‚¤ë§ˆ ìƒì„± ë° VectorDB ì„ë² ë”© ì™„ë£Œ'
                );

                // ì¦‰ì‹œ ì™„ë£Œ ìƒíƒœë¡œ ë³€ê²½
                setTimeout(() => {
                    const taskData = toast.tasks.get(taskId);
                    if (taskData) {
                        taskData.status = 'completed';
                        taskData.progress = 100;
                        taskData.currentStep = 'ì™„ë£Œ!';
                        toast.updateToast(taskData);
                    }
                }, 500);

                alert('ì™„ë£Œëœ ì‘ì—…ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }
        }

        function testErrorTask() {
            const taskId = generateTaskId();
            const toast = initBackgroundTaskToast();

            if (toast) {
                toast.addTask(
                    taskId,
                    'ğŸ“„ ì˜¤ë¥˜ ë°œìƒ ë¬¸ì„œ.pdf',
                    'PDF ì²˜ë¦¬ ì¤‘...'
                );

                // ì˜¤ë¥˜ ìƒíƒœë¡œ ë³€ê²½
                setTimeout(() => {
                    const taskData = toast.tasks.get(taskId);
                    if (taskData) {
                        taskData.status = 'error';
                        taskData.progress = 45;
                        taskData.currentStep = 'ì‹¤íŒ¨';
                        taskData.error = 'OpenAI API í˜¸ì¶œ ì‹¤íŒ¨: ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜';
                        toast.updateToast(taskData);
                    }
                }, 2000);

                alert('2ì´ˆ í›„ ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤!');
            }
        }

        function clearAllToasts() {
            const toast = initBackgroundTaskToast();
            if (toast) {
                toast.clearAll();
                alert('ëª¨ë“  í† ìŠ¤íŠ¸ê°€ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }
    </script>
</body>
</html>
