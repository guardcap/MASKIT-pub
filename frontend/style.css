:root{
  --bg:#ffffff;            
  --panel:#fbfcfe;         
  --side:#fbfcfe;          
  --card:#ffffff;          
  --line:#e6e9ef;          
  --text:#0b1220;          
  --muted:#5b6475;         
  --accent:#2563eb;        
  --accent-2:#8b5cf6;      
  --ok:#16a34a;            
  --warn:#f59e0b;          
  --shadow:0 8px 24px rgba(16,24,40,.06);
  --radius:18px;
  --chip:#f3f6fb;
  --chip-line:#e4eaf4;
  --pill:#eef3ff;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}

.app {
    display: grid;
    /* 새로운 헤더(상단바)를 위한 행 추가 */
    grid-template-rows: 60px 1fr;
    /* 기존 3개 열 레이아웃 유지 */
    grid-template-columns: 280px 1fr 340px; 
    /* 새로운 헤더 영역과 기존 3개 영역을 정의 */
    grid-template-areas:
        "header header header"
        "custombar panel sidebar";
    gap: 20px;
    max-width: 1500px;
    margin: 22px auto;
    padding: 0 18px;
}
.custombar {
    /* 그리드 영역 지정 */
    grid-area: custombar;
    background: var(--side);
    border: 1px solid var(--line);
    border-radius: 20px;
    box-shadow: var(--shadow);
    overflow: hidden;
}

.panel{
    /* 그리드 영역 지정 */
    grid-area: panel;
    background:var(--panel);
    border:1px solid var(--line);
    border-radius:20px;
    box-shadow:var(--shadow);
    min-height:80vh;
    overflow:hidden;
}
.sidebar{
    /* 그리드 영역 지정 */
    grid-area: sidebar;
    background:var(--side);
    border:1px solid var(--line);
    border-radius:20px;
    box-shadow:var(--shadow);
    overflow:hidden;
}

/* 공통 아이템 */
.custombar .item,
.sidebar .item {
  display: grid;
  grid-template-columns: auto 1fr auto;
  gap: 10px;
  align-items: center;
  border: 1px solid var(--line);
  border-radius: 12px;
  padding: 8px 10px;
  background: #fff;
}
.custombar .item.checked,
.sidebar .item.checked {
  background: #f0f4ff;
  border-radius: 6px;
}

/* 공통 체크박스 */
.custombar .checkbox,
.sidebar .checkbox {
  width:20px;
  height:20px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  border:1.5px solid #cfd6e3;
  border-radius:6px;
  background:#fff;
  cursor:pointer;
  position: relative;
}
.custombar .checkbox.on,
.sidebar .checkbox.on {
  background: var(--accent);
  border-color: var(--accent);
  color: #fff;
}
.custombar .checkbox.on::after,
.sidebar .checkbox.on::after {
  content: "✓";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 13px;
  font-weight: bold;
  color: #fff;
}

/* 공통 서브 드롭다운 */
.custombar .subdrop,
.sidebar .subdrop {
  margin: 8px 0 0 32px;
  padding: 0;
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.custombar .subdrop[hidden],
.sidebar .subdrop[hidden] {
  display: none;
}
.custombar .subitem,
.sidebar .subitem {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 10px;
  border: 1px solid var(--line);
  border-radius: 8px;
  background: #fff;
  font-size: 13px;
  color: var(--text);
  cursor: pointer;
}
.custombar .subitem .checkbox,
.sidebar .subitem .checkbox {
  width: 18px;
  height: 18px;
}
.custombar .subitem:hover,
.sidebar .subitem:hover {
  background: #f9fafc;
}

.custombar .group .items {
  display: grid;
  gap: 8px;
}

.custombar .group.collapsed .items {
  display: none;
}

/* 패널 하단 영역 */
.panel-footer {
  padding: 12px 0;
  display: flex;
  justify-content: center;   /* 버튼 중앙 정렬 */
  position: sticky;          /* 스크롤 내려도 하단에 고정 */
  bottom: 0;
  background: #fff;
  border-top: 1px solid #e0e0e0;
}

/* 편집 버튼 스타일 */
.panel-footer .btn.edit {
  min-width: 100px;       /* 버튼 가로 최소 폭 */
  max-width: 140px;       /* 버튼 가로 최대 폭 */
  padding: 8px 16px;      /* 버튼 높이 조정 */
  font-size: 14px;
  border-radius: 6px;
  background: var(--accent, #2563eb);
  color: #fff;
  border: none;
  cursor: pointer;
  transition: background 0.2s;
}

.panel{background:var(--panel);border:1px solid var(--line);border-radius:20px;box-shadow:var(--shadow);min-height:80vh;overflow:hidden}
.sidebar{background:var(--side);border:1px solid var(--line);border-radius:20px;box-shadow:var(--shadow);overflow:hidden}

/* top bar */
.top-bar {
    grid-area: header;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 16px;
    background-color: var(--bg);
    border-bottom: 1px solid var(--line);
}

.top-bar-title {
    font-size: 18px;
    font-weight: 600;
    color: var(--text);
}

.top-bar-button {
    padding: 8px 16px;
    border: 1px solid var(--line);
    border-radius: 8px;
    background-color: var(--panel);
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: background-color 0.2s ease;
}

.top-bar-button:hover {
    background-color: #e0e0e0;
}

.top{display:flex;align-items:center;justify-content:space-between;padding:16px 18px;border-bottom:1px solid var(--line);gap:12px;background:#fff}
.recipients{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.chip{display:inline-flex;align-items:center;gap:8px;background:var(--chip);border:1px solid var(--chip-line);color:var(--text);padding:8px 12px;border-radius:999px;font-size:12px;max-width:240px}
.chip .text{display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:180px}
.more-btn{display:none;border:1px solid var(--line);background:#fff;border-radius:999px;padding:6px 10px;font-size:12px;cursor:pointer}
.more-btn:hover{background:#f7fafc}

.me {
  display: flex;
  align-items: center;
  gap: 10px;
}

.avatar {
  width: 32px;
  height: 32px;
  border-radius: 999px;
  background: linear-gradient(135deg,#93c5fd,#c4b5fd);
}

.who {
  display: flex;
  flex-direction: column; /* 세로 배치 */
  line-height: 1.3;       /* 줄 간격 */
}

.who .team {
  font-size: 12px;
  color: var(--muted);
  white-space: nowrap;    /* 줄바꿈 방지 */
}

.who .nick {
  font-weight: 600;
  font-size: 14px;
  color: var(--text);
}


/* first row: overview + stats */
.row{padding:16px}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px}
.card h4{margin:0 0 10px 0;font-size:14px}
.card p{margin:6px 0;color:var(--muted);line-height:1.6}
.legend{display:grid;gap:8px}
.legend .row{display:flex;align-items:center;gap:10px}
.legend .bar{width:42px;height:12px;border-radius:4px}
.legend .t{color:var(--muted);font-size:12px}
.bar.c1{background:linear-gradient(90deg,#60a5fa,#a78bfa)}
.bar.c2{background:linear-gradient(90deg,#86efac,#22c55e)}
.bar.c3{background:linear-gradient(90deg,#fde047,#fb923c)}
.bar.c4{background:linear-gradient(90deg,#93c5fd,#d8b4fe)}

/* file menu bar */
.filebar {
    display: flex;
    gap: 8px;
    align-items: center;
    padding: 8px 16px;
    border-top: 1px dashed var(--line);
    border-bottom: 1px solid var(--line);
    background: #fff;
    
    /* 아래 세 줄을 추가하여 가로 스크롤을 활성화합니다. */
    flex-wrap: nowrap;
    overflow-x: auto;
    white-space: nowrap;
}

/* 스크롤바를 숨기고 싶다면 아래 코드를 추가하세요. */
.filebar::-webkit-scrollbar {
    display: none;
}

.tab{border:1px solid var(--line);background:#fff;border-radius:999px;padding:8px 12px;font-size:13px;cursor:pointer}
.tab.active{background:#eef2ff;border-color:#a5b4fc;color:#1e3a8a}

/* content area */
.content{padding:16px}

.editor{background:var(--card);border:1px solid var(--line);border-radius:16px;overflow:hidden}
.toolbar{display:flex;gap:8px;align-items:center;padding:8px 10px;border-bottom:1px solid var(--line);background:#fff}
.tool{display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;border-radius:8px;border:1px solid var(--line);background:#fff;cursor:pointer}
.tool:hover{background:#f7fafc}

.doc{padding:18px 20px 24px}
.doc h2{margin:4px 0 10px;font-size:18px}
.doc h3{margin:18px 0 10px;font-size:16px}
.doc p{margin:10px 0;color:#2f3640;line-height:1.8}

.mark{background:#fef3c7;border-radius:8px;padding:0 4px}
.mark.active{background:#fde68a;box-shadow:0 0 0 3px #fde68a66}
.mark.masked{filter:blur(5px)}

/* embeds */
.view{display:none}
.view.active{display:block}
.embed-img{max-width:100%;border:1px solid var(--line);border-radius:12px;box-shadow:var(--shadow)}
.embed-pdf{width:100%;height:70vh;border:1px solid var(--line);border-radius:12px;background:#fafafa}
.pdf-fallback{padding:16px;color:var(--muted)}

/* text file editor */
.text-editor{background:#fff;border:1px solid var(--line);border-radius:12px;padding:14px;min-height:260px;line-height:1.7}

/* sidebar */
.sb-head{display:flex;align-items:center;gap:12px;padding:16px 16px;border-bottom:1px solid var(--line);background:#fff}
.sb-title{font-weight:600}

.group{border-bottom:1px dashed var(--line);background:#fff}
.group-toggle{width:100%;text-align:left;background:#fff;border:0;border-bottom:1px solid var(--line);padding:12px 14px;display:flex;align-items:center;gap:10px;cursor:pointer}
.group-toggle .caret{
  margin-left:auto;
  transition:transform .2s ease;
  transform:rotate(90deg);   /* 열림: ▼ */
}
.group.collapsed .group-toggle .caret{
  transform:rotate(0deg);    /* 닫힘: ▶ */
}

.items{list-style:none;margin:0;padding:10px 10px 10px 12px;display:grid;gap:8px}
.checkbox svg{width:16px;height:16px}
.txt{font-size:13px;color:#111827}

.right{display:flex;align-items:center;gap:6px}
.mini-rect{width:14px;height:10px;border:1px solid #a5b4fc;border-radius:2px;background:#eef2ff;display:none}
.act-icons{display:none;gap:6px}
.icon{width:26px;height:26px;border:1px solid var(--line);border-radius:8px;background:#fff;display:inline-flex;align-items:center;justify-content:center;cursor:pointer}
.icon:hover{background:#f8fafc}

.item.selected .mini-rect{display:inline-block}
.item.selected .act-icons{display:flex}

.hidden{display:none}

/* PII 마스킹 리스트 추가 스타일 */
.sidebar .item .meta {
  margin-top: 4px;
  opacity: 0.7;
  font-size: 11px;
  color: #666;
  grid-column: 2;
}

.sidebar .item .meta small {
  font-weight: normal;
}

.sidebar .item .actions {
  display: flex;
  gap: 4px;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.sidebar .item:hover .actions {
  opacity: 1;
}

.action-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border: none;
  border-radius: 4px;
  background: #f0f0f0;
  color: #666;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 12px;
}

.action-btn:hover {
  background: #e0e0e0;
  color: #333;
}

.action-btn.ok {
  background: #4caf50;
  color: white;
}

.empty-state {
  padding: 20px;
  text-align: center;
  color: #999;
  font-size: 14px;
}

.empty-state p {
  margin: 0;
}

/* PII 타입별 색상 테마 */
.sidebar .group[data-type="EMAIL"] .group-toggle {
  border-left: 4px solid #4caf50;
}

.sidebar .group[data-type="PHONE"] .group-toggle {
  border-left: 4px solid #ff9800;
}

.sidebar .group[data-type="PERSON"] .group-toggle {
  border-left: 4px solid #9c27b0;
}

.sidebar .group[data-type="BANK_ACCOUNT"] .group-toggle {
  border-left: 4px solid #ce82e6;
}

.sidebar .group[data-type="CREDIT_CARD"] .group-toggle {
  border-left: 4px solid #f44336;
}

.sidebar .group[data-type="IP_ADDRESS"] .group-toggle {
  border-left: 4px solid #2196f3;
}

.sidebar .group[data-type="DATE_TIME"] .group-toggle {
  border-left: 4px solid #795548;
}

.sidebar .group[data-type="LOCATION"] .group-toggle {
  border-left: 4px solid #607d8b;
}

.sidebar .group[data-type="ORGANIZATION"] .group-toggle {
  border-left: 4px solid #3f51b5;
}

@media (max-width: 1100px){
  .app{grid-template-columns:1fr}
  .sidebar{order:-1}
}

/* 모달 */
.modal {
  position: fixed;
  top:0; left:0; right:0; bottom:0;
  background: rgba(0,0,0,0.4);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}
.modal.hidden { display: none; }
.modal-content {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  box-shadow: var(--shadow);
  text-align: center;
  max-width: 320px;
}
.modal-content p {
  margin: 0;
  font-size: 14px;
  color: var(--text);
}
.modal-content button {
  margin-top: 16px;
  padding: 8px 16px;
  border: none;
  background: var(--accent);
  color: #fff;
  border-radius: 6px;
  cursor: pointer;
}
.modal-content button:hover {
  background: #1d4ed8;
}

/* 수정 가능한 단락 스타일 */
.editable-paragraph {
    padding: 4px 8px;
    border-radius: 4px;
    transition: background-color 0.2s ease;
}

.editable-paragraph:hover {
    background-color: #f8f9fa;
}

.editable-paragraph:focus {
    outline: 2px solid #2563eb;
    outline-offset: 2px;
    background-color: #f0f4ff;
}

/* 수정 중임을 나타내는 커서 */
.editable-paragraph[contenteditable="true"] {
    cursor: text;
}